## 테스트 1: 라우팅 검증

### 1. 테스트 목적
ALB가 HTTP 요청을 정의된 경로 규칙에 따라 Target Group으로 전달하는지 확인

### 2. 테스트 방법
/api/orders
- Postman으로 각 엔드포인트 호출
- ALB Access Log 확인

### 3. 예상 결과
- /api/orders → 200 OK, Order Service 응답
- ALB가 예상된 Target Group으로 라우팅한 기록 확인 

### 4. 성공 기준
- 1개 엔드포인트 모두 정상 응답
- 라우팅 오류(502/503/404) 미발생

---

## 테스트 2: 헬스체크 및 자동 복구

### 1. 테스트 목적
ECS Task가 비정상 종료되거나 장애가 발생했을 때 서비스 중단 없는 자동 복구 확인

### 2. 테스트 방법

1. 콘솔에서 Order-Service Task 임의 종료
2. 종료 직후 30~90초 동안 /api/orders 지속 호출
3. ECS Event 탭에서 Health Check 실패 → Task 재기동 로그 확인
4. 전체 복구까지 걸린 시간 측정

### 3. 예상 결과
- Task 종료 후 30초 이내에 감지
- 다른 Task로 트래픽 자동 전환
- 1분 이내에 새 Task 시작
- 사용자는 에러를 거의 느끼지 않음

### 4. 성공 기준
- 요청 실패율 < 1%
- 복구 소요 시간 : 1분 이내 
- 자동 복구 완료

---

## 테스트 3: 무중단 배포

### 1. 테스트 목적
신규 버전 배포 시, 기존 서비스가 중단되거나 요청이 무시 되지 않고 정상적으로 동작하는지 확인

### 2. 테스트 방법
1. 배포 중 120번 요청 실행
2. 배포 진행 단계에서 응답 코드 분포, Latency 변화 모니터링 (CloudWatch Metrics)
3. 요청 실패 여부 확인

### 3. 예상 결과
- 배포 중에도 요청 성공
- 구버전에서 신버전으로 점진적 전환

### 4. 성공 기준
- 요청 실패 0건

---

## 간단한 모니터링 계획

**어떤 지표를 볼 것인가:**

| 지표명 | 의미 | 정상 범위 | 위험 신호(알람 트리거) | 관찰 이유 |
| --- | --- | --- | --- | --- |
| **HealthyHostCount** | 요청을 받을 수 있는 Task 수 | ≥ 2 (배포 중 최소 1 이상 유지) | 0 또는 1 이하 | Task 교체 과정에서 모두 종료되면 트래픽 Drop 발생 |
| **TargetResponseTime** | 사용자 관점 응답 지연 시간 | < 1초 | 2초 이상 지속(1분 이상) | 신규 Task warmed-up 늦음, DB 연결지연 등 |
| **HTTPCode_Target_5XX** | 서버 오류 응답 수 | 0건 | 분당 10건 이상 또는 증가 추세 | 배포 실패, 신규 Task 오류, Config mismatch |
| **RequestCount** | 전체 요청 수 | 평소 대비 ±20% | 급감 또는 급증 | 트래픽이 특정 Task로 몰리거나 요청 Drop 가능성 |

**알람 설정:**

| 상황 | 발생 조건 |
| --- | --- |
| 전체 Task Unhealthy | `HealthyHostCount == 0` |
| 응답 지연 증가 | `TargetResponseTime > 2초` 1분 이상 |
| 서버 오류 증가 | `5xx > 10건/분` |
| 트래픽 감소 | `RequestCount 급감` |

---
